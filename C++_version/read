Here's the C++ version.
